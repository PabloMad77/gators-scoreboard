<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Gators Scoreboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  background: #004a87;
  color: white;
  margin: 0;
  padding: 20px;
}

h1 {
  margin-bottom: 10px;
}

input {
  padding: 8px;
  font-size: 18px;
  border-radius: 8px;
  border: none;
  text-align: center;
}

.score-container {
  display: flex;
  justify-content: space-around;
  margin: 30px 0;
  flex-wrap: wrap;
}

.team {
  background: white;
  color: #004a87;
  padding: 20px;
  border-radius: 15px;
  width: 300px;
  margin: 10px;
}

.score {
  font-size: 70px;
  margin: 20px 0;
}

button {
  padding: 10px 15px;
  font-size: 18px;
  margin: 5px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
}

.add1 { background: #28a745; color: white; }
.add6 { background: #17a2b8; color: white; }
.sub { background: #dc3545; color: white; }
.export-btn { background: #ffc107; color: black; margin-top: 20px; }
.reset-btn { background: black; color: white; margin-top: 10px; }

</style>
</head>

<body>

<h1>Gators Scoreboard</h1>

<div class="score-container">

  <div class="team">
    <h2>Gators</h2>
    <div class="score" id="gatorsScore">0</div>
    <button class="add1" onclick="updateScore('gators',1)">+1</button>
    <button class="add6" onclick="updateScore('gators',6)">+6</button>
    <button class="sub" onclick="updateScore('gators',-1)">-1</button>
  </div>

  <div class="team">
    <input type="text" id="opponentName" placeholder="Opponent Name" oninput="saveState()">
    <div class="score" id="opponentScore">0</div>
    <button class="add1" onclick="updateScore('opponent',1)">+1</button>
    <button class="add6" onclick="updateScore('opponent',6)">+6</button>
    <button class="sub" onclick="updateScore('opponent',-1)">-1</button>
  </div>

</div>

<button class="export-btn" onclick="exportScore()">Export Score Image</button>
<br>
<button class="reset-btn" onclick="resetGame()">Reset Game</button>

<script>

// ---------------- STATE ----------------

let gatorsScore = 0;
let opponentScore = 0;

// ---------------- LOAD SAVED ----------------

window.onload = function() {
  const saved = JSON.parse(localStorage.getItem("gatorsGame"));

  if (saved) {
    gatorsScore = saved.gators;
    opponentScore = saved.opponent;
    document.getElementById("gatorsScore").innerText = gatorsScore;
    document.getElementById("opponentScore").innerText = opponentScore;
    document.getElementById("opponentName").value = saved.opponentName;
  }
};

// ---------------- SAVE ----------------

function saveState() {
  const data = {
    gators: gatorsScore,
    opponent: opponentScore,
    opponentName: document.getElementById("opponentName").value
  };

  localStorage.setItem("gatorsGame", JSON.stringify(data));
}

// ---------------- UPDATE SCORE ----------------

function updateScore(team, value) {

  if (team === "gators") {
    gatorsScore = Math.max(0, gatorsScore + value);
    document.getElementById("gatorsScore").innerText = gatorsScore;
  } else {
    opponentScore = Math.max(0, opponentScore + value);
    document.getElementById("opponentScore").innerText = opponentScore;
  }

  saveState();
}

// ---------------- RESET ----------------

function resetGame() {
  if (confirm("Reset the game?")) {
    gatorsScore = 0;
    opponentScore = 0;
    document.getElementById("gatorsScore").innerText = 0;
    document.getElementById("opponentScore").innerText = 0;
    document.getElementById("opponentName").value = "";
    localStorage.removeItem("gatorsGame");
  }
}

// ---------------- EXPORT ----------------

function exportScore() {

  const canvas = document.createElement("canvas");
  canvas.width = 1080;
  canvas.height = 1080;
  const ctx = canvas.getContext("2d");

  // Background
  ctx.fillStyle = "#004a87";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  const logo = new Image();
  logo.src = "logo.PNG";

  logo.onload = function() {

    // Proportional Logo
    const desiredWidth = 500;
    const scale = desiredWidth / logo.width;
    const newHeight = logo.height * scale;

    const xPosition = (canvas.width - desiredWidth) / 2;
    const yPosition = 120;

    ctx.drawImage(logo, xPosition, yPosition, desiredWidth, newHeight);

    // Title
    ctx.fillStyle = "white";
    ctx.textAlign = "center";
    ctx.font = "bold 70px Arial";
    ctx.fillText("FINAL SCORE", 540, 650);

    // Scores
    ctx.font = "bold 90px Arial";
    ctx.fillText("GATORS " + gatorsScore, 540, 820);

    const opponentName = document.getElementById("opponentName").value || "OPPONENT";
    ctx.fillText(opponentName.toUpperCase() + " " + opponentScore, 540, 950);

    // Date + Time Stamp
    const now = new Date();
    const formattedDate = now.toLocaleDateString();
    const formattedTime = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

    ctx.font = "40px Arial";
    ctx.fillText(formattedDate + " â€¢ " + formattedTime, 540, 1030);

    // File name with timestamp
    const safeDate = now.toISOString().replace(/[:.]/g, "-");
    const link = document.createElement("a");
    link.download = "gators-final-score-" + safeDate + ".PNG";
    link.href = canvas.toDataURL("image/PNG");
    link.click();
  };

  logo.onerror = function() {
    alert("Logo not found. Make sure logo.png is in the same folder.");
  };
}

</script>

</body>
</html>
